

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Ecomap API Documentation &mdash; Ecomap 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="static/css/theme.css" type="text/css" />
  

  

  
        <link rel="author" title="About these documents"
              href="about.html"/>
    <link rel="top" title="Ecomap 0.1 documentation" href="index.html"/>
        <link rel="next" title="About Project" href="about.html"/>
        <link rel="prev" title="Welcome to Ecomap.org documentation!" href="index.html"/> 

  
  <script src="static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Ecomap
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">Ecomap API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-views">API start</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-admin_views">Admin API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#resources">resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="#permissions">permissions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#roles">roles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#role-permission">role_permission</a></li>
<li class="toctree-l3"><a class="reference internal" href="#static-pages-api">Static Pages API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#user-api">User API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#authentication">authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restore-user-password">restore user password</a></li>
<li class="toctree-l3"><a class="reference internal" href="#change-user-password">change user password</a></li>
<li class="toctree-l3"><a class="reference internal" href="#user-profile">user profile</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#problem-api">Problem API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-problem_views">adding and viewing problems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#photos">photos</a></li>
<li class="toctree-l3"><a class="reference internal" href="#comments">comments</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">About Project</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="sourcecode.html">View Sourcecode</a></li>
<li class="toctree-l1"><a class="reference internal" href="guide.html">Installation Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Ecomap</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Ecomap API Documentation</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="sources/flask.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ecomap-api-documentation">
<h1>Ecomap API Documentation<a class="headerlink" href="#ecomap-api-documentation" title="Permalink to this headline">¶</a></h1>
<p>Ecomap.org is a web service build on RESTful Api concept.
It has web-application, ios and android based clients</p>
<div class="section" id="module-views">
<span id="api-start"></span><h2>API start<a class="headerlink" href="#module-views" title="Permalink to this headline">¶</a></h2>
<p>This module holds all views controls for
ecomap project.</p>
<dl class="get">
<dt id="get--">
<code class="descname">GET </code><code class="descname">/</code><a class="headerlink" href="#get--" title="Permalink to this definition">¶</a></dt>
<dd><p>Controller starts main application page.
Shows initial data of application, renders template with built-in Angular
JS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body">renders html template with angular app.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="views.index">
<code class="descclassname">views.</code><code class="descname">index</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="modules/views.html#index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#views.index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-admin_views">
<span id="admin-api"></span><h2>Admin API<a class="headerlink" href="#module-admin_views" title="Permalink to this headline">¶</a></h2>
<p>Module contains routes, used for admin page.</p>
<div class="section" id="resources">
<h3>resources<a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="admin_views.resource_post">
<code class="descclassname">admin_views.</code><code class="descname">resource_post</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="modules/admin_views.html#resource_post"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#admin_views.resource_post" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>this routes handles REST operations with site resources</p>
<p><code class="docutils literal"><span class="pre">&#64;login_required</span></code></p>
<dl class="docutils">
<dt>access for role:</dt>
<dd>admin</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">request headers:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body"><ul class="first simple">
<li>Accept: <cite>application/json, text/plain, */*</cite></li>
<li>Authorization: <cite>remember_token to authenticate</cite></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">response header:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><ul class="first last simple">
<li>Content-Type: <cite>application/json</cite></li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="get">
<dt id="get--api-resources">
<code class="descname">GET </code><code class="descname">/api/resources</code><a class="headerlink" href="#get--api-resources" title="Permalink to this definition">¶</a></dt>
<dd><p>Function which returns resources list from db with pagination options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Query Parameters:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><ul class="first simple">
<li><strong>offset</strong> &#8211; offset number. default is 0</li>
<li><strong>limit</strong> &#8211; limit number. default is 5</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If resource list is not empty:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">[[{&quot;resource_name&quot;:</span> <span class="pre">&quot;name&quot;,</span> <span class="pre">&quot;id&quot;:</span> <span class="pre">1},</span>
<span class="pre">{&quot;resource_name&quot;:</span> <span class="pre">&quot;name_2&quot;,</span> <span class="pre">&quot;id&quot;:</span> <span class="pre">2}],</span>
<span class="pre">[{&quot;total_res_count&quot;:</span> <span class="pre">2}]]</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If there are no resources:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; no errors</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="post">
<dt id="post--api-resources">
<code class="descname">POST </code><code class="descname">/api/resources</code><a class="headerlink" href="#post--api-resources" title="Permalink to this definition">¶</a></dt>
<dd><p>Function which adds new site resource to site-map in admin panel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Request agrs:</th><td class="field-body"><p class="first"><cite>{resource_name: &#8220;/res_name&#8221;}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If there is already resource with this name:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'error':</span> <span class="pre">'resource</span> <span class="pre">already</span> <span class="pre">exists'}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If request data is invalid:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">False,</span> <span class="pre">'error':</span> <span class="pre">[list</span> <span class="pre">of</span> <span class="pre">errors]}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If all ok:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'added_resource':</span> <span class="pre">'resource_name',</span>
<span class="pre">'resource_id':</span> <span class="pre">'resource_id'}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400 Bad Request</a> &#8211; resource already exists or request is invalid</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; resource was successfully posted</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="put">
<dt id="put--api-resources">
<code class="descname">PUT </code><code class="descname">/api/resources</code><a class="headerlink" href="#put--api-resources" title="Permalink to this definition">¶</a></dt>
<dd><p>Function which edits resource name by its id.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Request args:</th><td class="field-body"><p class="first"><cite>{resource_name: &#8220;new_res_name&#8221;, resource_id: 29}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If there is already resource with this name:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'error':</span> <span class="pre">'this</span> <span class="pre">name</span> <span class="pre">already</span> <span class="pre">exists'}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If request data is invalid:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">False,</span> <span class="pre">'error':</span> <span class="pre">[list</span> <span class="pre">of</span> <span class="pre">errors]}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If all ok:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">'success',</span> <span class="pre">'edited':</span> <span class="pre">'resource_name'}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400 Bad Request</a> &#8211; resource already exists or request is invalid</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; resource was successfully posted</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="delete">
<dt id="delete--api-resources">
<code class="descname">DELETE </code><code class="descname">/api/resources</code><a class="headerlink" href="#delete--api-resources" title="Permalink to this definition">¶</a></dt>
<dd><p>Function which deletes resource from database by id.
Before delete checks if resource have any permissions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Request args:</th><td class="field-body"><p class="first"><cite>{resource_id: 29}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If resource has assigned permissions:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'error':</span> <span class="pre">'Cannot</span> <span class="pre">delete!'}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If request data is invalid:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">False,</span> <span class="pre">'error':</span> <span class="pre">[list</span> <span class="pre">of</span> <span class="pre">errors]}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If all ok:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">'success',</span> <span class="pre">'deleted_resource':</span> <span class="pre">'resource_id'}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400 Bad Request</a> &#8211; if resource has assigned permissions or request invalid</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; resource was deleted successfully</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="permissions">
<h3>permissions<a class="headerlink" href="#permissions" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="admin_views.permission_post">
<code class="descclassname">admin_views.</code><code class="descname">permission_post</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="modules/admin_views.html#permission_post"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#admin_views.permission_post" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>this group of rotes provides control of permissions to site resources URLs</p>
<p><code class="docutils literal"><span class="pre">&#64;login_required</span></code></p>
<dl class="docutils">
<dt>access for role:</dt>
<dd>admin</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">request headers:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body"><ul class="first simple">
<li>Accept: <cite>application/json, text/plain, */*</cite></li>
<li>Authorization: <cite>remember_token to authenticate</cite></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">response header:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><ul class="first last simple">
<li>Content-Type: <cite>application/json</cite></li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="get">
<dt id="get--api-permissions">
<code class="descname">GET </code><code class="descname">/api/permissions</code><a class="headerlink" href="#get--api-permissions" title="Permalink to this definition">¶</a></dt>
<dd><p>Function which gets all permissions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Query Parameters:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><ul class="first simple">
<li><strong>resource_id</strong> &#8211; id of site resource(int)</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If resource list is not empty for this id:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'permission_id':</span> <span class="pre">'permission_id',</span> <span class="pre">'action':</span> <span class="pre">'action',</span>
<span class="pre">'modifier':</span> <span class="pre">'modifier',</span> <span class="pre">'description':</span> <span class="pre">'description'}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If there are no permissions for selected resource_id:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; no errors</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="post">
<dt id="post--api-permissions">
<code class="descname">POST </code><code class="descname">/api/permissions</code><a class="headerlink" href="#post--api-permissions" title="Permalink to this definition">¶</a></dt>
<dd><p>Function which adds new permission into database.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Request args example:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first"><cite>{action: &#8220;DELETE&#8221;,
description: &#8220;TEST&#8221;,
modifier: &#8220;None&#8221;,
resource_id: &#8220;33&#8221;}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If request data is invalid:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">False,</span> <span class="pre">'error':</span> <span class="pre">[list</span> <span class="pre">of</span> <span class="pre">errors]}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If all ok:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'added_permission':</span> <span class="pre">'description',</span>
<span class="pre">'permission_id':</span> <span class="pre">'permission_id'}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400 Bad Request</a> &#8211; invalid request</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; permission has been successfully added</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="put">
<dt id="put--api-permissions">
<code class="descname">PUT </code><code class="descname">/api/permissions</code><a class="headerlink" href="#put--api-permissions" title="Permalink to this definition">¶</a></dt>
<dd><p>Function which edits permission.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Request args example:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first"><cite>{action: &#8220;POST&#8221;,
description: &#8220;edited description&#8221;,
modifier: &#8220;Any&#8221;,
resource_id: &#8220;33&#8221;}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If request data is invalid:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">False,</span> <span class="pre">'error':</span> <span class="pre">[list</span> <span class="pre">of</span> <span class="pre">errors]}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If all ok:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">'success',</span>
<span class="pre">'edited_perm_id':</span> <span class="pre">'permission_id'}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400 Bad Request</a> &#8211; invalid request</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; if no errors</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="delete">
<dt id="delete--api-permissions">
<code class="descname">DELETE </code><code class="descname">/api/permissions</code><a class="headerlink" href="#delete--api-permissions" title="Permalink to this definition">¶</a></dt>
<dd><p>Function which deletes permission by it id.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Request args example:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first"><cite>{permission_id: 5}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If permission was binded to some role:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'error':</span> <span class="pre">'Cannot</span> <span class="pre">delete!'}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If request data is invalid:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">False,</span> <span class="pre">'error':</span> <span class="pre">[list</span> <span class="pre">of</span> <span class="pre">errors]}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If all ok:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">'success',</span>
<span class="pre">'edited_perm_id':</span> <span class="pre">'permission_id'}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400 Bad Request</a> &#8211; if role has assigned permissions or request invalid</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; if no errors</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="get">
<dt id="get--api-all_permissions">
<code class="descname">GET </code><code class="descname">/api/all_permissions</code><a class="headerlink" href="#get--api-all_permissions" title="Permalink to this definition">¶</a></dt>
<dd><p>Function sends all created permissions to frontend. Handles with
pagination options defined in query arguments.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Query Parameters:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><ul class="first simple">
<li><strong>offset</strong> &#8211; pgination offset number. default is 0</li>
<li><strong>limit</strong> &#8211; pagination limit number. default is 5</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If permission tuple from DB is not empty:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">[[{&quot;action&quot;:</span> <span class="pre">&quot;POST&quot;,</span> <span class="pre">&quot;permission_id&quot;:</span> <span class="pre">6,</span>
<span class="pre">&quot;resource_name&quot;:</span> <span class="pre">&quot;/api/register&quot;,</span>
<span class="pre">&quot;modifier&quot;:</span> <span class="pre">&quot;Any&quot;,</span>
<span class="pre">&quot;description&quot;:</span> <span class="pre">&quot;register</span> <span class="pre">user</span> <span class="pre">into</span> <span class="pre">app&quot;}],</span>
<span class="pre">[{&quot;total_perm_count&quot;:</span> <span class="pre">46}]]</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If there are no permissions:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; no errors</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="roles">
<h3>roles<a class="headerlink" href="#roles" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="admin_views.role_post">
<code class="descclassname">admin_views.</code><code class="descname">role_post</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="modules/admin_views.html#role_post"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#admin_views.role_post" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>this routes handles REST operations with site role base access control</p>
<p><code class="docutils literal"><span class="pre">&#64;login_required</span></code></p>
<dl class="docutils">
<dt>access for role:</dt>
<dd>admin</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">request headers:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body"><ul class="first simple">
<li>Accept: <cite>application/json, text/plain, */*</cite></li>
<li>Authorization: <cite>remember_token to authenticate</cite></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">response header:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><ul class="first last simple">
<li>Content-Type: <cite>application/json</cite></li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="get">
<dt id="get--api-roles">
<code class="descname">GET </code><code class="descname">/api/roles</code><a class="headerlink" href="#get--api-roles" title="Permalink to this definition">¶</a></dt>
<dd><p>Function which gets all roles of user from database.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If no roles in DB:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If roles exists:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'role_name':</span> <span class="pre">'role_id',...,</span> <span class="pre">'role_name2':</span> <span class="pre">'role_id'}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; if no errors</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="post">
<dt id="post--api-roles">
<code class="descname">POST </code><code class="descname">/api/roles</code><a class="headerlink" href="#post--api-roles" title="Permalink to this definition">¶</a></dt>
<dd><p>Function which adds new role into database.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Request args:</th><td class="field-body"><p class="first"><cite>{&#8220;role_name&#8221;:&#8221;test&#8221;}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If there is already role with this name:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'error':</span> <span class="pre">'role</span> <span class="pre">already</span> <span class="pre">exists'}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If request data is invalid:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">False,</span> <span class="pre">'error':</span> <span class="pre">[list</span> <span class="pre">of</span> <span class="pre">errors]}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If all ok:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'added_role':</span> <span class="pre">'role_name',</span>
<span class="pre">'added_role_id':</span> <span class="pre">'role_id'}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400 Bad Request</a> &#8211; If role with this name exists or request is invalid</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; If no errors</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="put">
<dt id="put--api-roles">
<code class="descname">PUT </code><code class="descname">/api/roles</code><a class="headerlink" href="#put--api-roles" title="Permalink to this definition">¶</a></dt>
<dd><p>Function which edits role name by it id.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Request args:</th><td class="field-body"><p class="first"><cite>{role_name: &#8220;new_name&#8221;, role_id: 5}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If there is already resource with this name:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'error':</span> <span class="pre">'this</span> <span class="pre">name</span> <span class="pre">already</span> <span class="pre">exists'}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If request data is invalid:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">False,</span> <span class="pre">'error':</span> <span class="pre">[list</span> <span class="pre">of</span> <span class="pre">errors]}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If all ok:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">'success',</span> <span class="pre">'edited':</span> <span class="pre">'resource_name'}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400 Bad Request</a> &#8211; if role with this name exists or request is invalid</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; if no errors</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="delete">
<dt id="delete--api-roles">
<code class="descname">DELETE </code><code class="descname">/api/roles</code><a class="headerlink" href="#delete--api-roles" title="Permalink to this definition">¶</a></dt>
<dd><p>Function which deletes role from database by it id.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Request args:</th><td class="field-body"><p class="first"><cite>{role_id: 5}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If role has permissions:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'error':</span> <span class="pre">'Cannot</span> <span class="pre">delete!'}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If request data is invalid:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">False,</span> <span class="pre">error:</span> <span class="pre">[list</span> <span class="pre">of</span> <span class="pre">errors]}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If all ok:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">'success',</span> <span class="pre">'deleted_role':</span> <span class="pre">'role_id'}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400 Bad Request</a> &#8211; if role has assigned permissions or request invalid</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; if no errors</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="post">
<dt id="post--api-user_roles">
<code class="descname">POST </code><code class="descname">/api/user_roles</code><a class="headerlink" href="#post--api-user_roles" title="Permalink to this definition">¶</a></dt>
<dd><p>Function, used to get all users.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body">list of all users with id, first name, last name, email and role</td>
</tr>
</tbody>
</table>
<p><code class="docutils literal"><span class="pre">[{&quot;role&quot;:</span> <span class="pre">&quot;admin&quot;,</span> <span class="pre">&quot;first_name&quot;:</span> <span class="pre">&quot;Admin&quot;,</span> <span class="pre">&quot;last_name&quot;:</span> <span class="pre">&quot;Administrator&quot;,</span>
<span class="pre">&quot;user_id&quot;:</span> <span class="pre">3,</span> <span class="pre">&quot;email&quot;:</span> <span class="pre">&quot;admin&#64;ecomap.com&quot;}</span>
<span class="pre">...</span>
<span class="pre">{&quot;role&quot;:</span> <span class="pre">&quot;user&quot;,</span> <span class="pre">&quot;first_name&quot;:</span> <span class="pre">&quot;Oleg&quot;,</span> <span class="pre">&quot;last_name&quot;:</span> <span class="pre">&quot;Lyashko&quot;,</span>
<span class="pre">&quot;user_id&quot;:</span> <span class="pre">4,</span> <span class="pre">&quot;email&quot;:</span> <span class="pre">&quot;radical&#64;gmail.com&quot;}</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; no errors</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400 Bad Request</a> &#8211; invalid request</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="get">
<dt id="get--api-user_roles">
<code class="descname">GET </code><code class="descname">/api/user_roles</code><a class="headerlink" href="#get--api-user_roles" title="Permalink to this definition">¶</a></dt>
<dd><p>Function, used to get all users.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body">list of all users with id, first name, last name, email and role</td>
</tr>
</tbody>
</table>
<p><code class="docutils literal"><span class="pre">[{&quot;role&quot;:</span> <span class="pre">&quot;admin&quot;,</span> <span class="pre">&quot;first_name&quot;:</span> <span class="pre">&quot;Admin&quot;,</span> <span class="pre">&quot;last_name&quot;:</span> <span class="pre">&quot;Administrator&quot;,</span>
<span class="pre">&quot;user_id&quot;:</span> <span class="pre">3,</span> <span class="pre">&quot;email&quot;:</span> <span class="pre">&quot;admin&#64;ecomap.com&quot;}</span>
<span class="pre">...</span>
<span class="pre">{&quot;role&quot;:</span> <span class="pre">&quot;user&quot;,</span> <span class="pre">&quot;first_name&quot;:</span> <span class="pre">&quot;Oleg&quot;,</span> <span class="pre">&quot;last_name&quot;:</span> <span class="pre">&quot;Lyashko&quot;,</span>
<span class="pre">&quot;user_id&quot;:</span> <span class="pre">4,</span> <span class="pre">&quot;email&quot;:</span> <span class="pre">&quot;radical&#64;gmail.com&quot;}</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; no errors</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400 Bad Request</a> &#8211; invalid request</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="get">
<dt id="get--api-user_page">
<code class="descname">GET </code><code class="descname">/api/user_page</code><a class="headerlink" href="#get--api-user_page" title="Permalink to this definition">¶</a></dt>
<dd><p>Function which returns users list from db with pagination options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Query Parameters:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><ul class="first simple">
<li><strong>offset</strong> &#8211; pagination offset number. default is 0</li>
<li><strong>limit</strong> &#8211; pagination limit number. default is 5</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><p class="first"><code class="docutils literal"><span class="pre">[[{&quot;role_name&quot;:</span> <span class="pre">&quot;admin&quot;,</span>
<span class="pre">&quot;first_name&quot;:</span> <span class="pre">&quot;username&quot;,</span>
<span class="pre">&quot;last_name&quot;:</span> <span class="pre">&quot;UserSurname&quot;,</span>
<span class="pre">&quot;id&quot;:</span> <span class="pre">1,</span>
<span class="pre">&quot;email&quot;:</span> <span class="pre">&quot;email&#64;name.ru&quot;},</span>
<span class="pre">....</span>
<span class="pre">{&quot;role_name&quot;:</span> <span class="pre">&quot;user&quot;,</span>
<span class="pre">&quot;first_name&quot;:</span> <span class="pre">&quot;Username&quot;,</span>
<span class="pre">&quot;last_name&quot;:</span> <span class="pre">&quot;UserSurname&quot;,</span>
<span class="pre">&quot;id&quot;:</span> <span class="pre">5,</span>
<span class="pre">&quot;email&quot;:</span> <span class="pre">&quot;email&#64;gmail.com&quot;}],</span>
<span class="pre">[{&quot;total_users&quot;:</span> <span class="pre">2}]]</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; no errors</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="role-permission">
<h3>role_permission<a class="headerlink" href="#role-permission" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="admin_views.role_permission_post">
<code class="descclassname">admin_views.</code><code class="descname">role_permission_post</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="modules/admin_views.html#role_permission_post"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#admin_views.role_permission_post" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>this routes handles REST operations with site role base access control</p>
<p><code class="docutils literal"><span class="pre">&#64;login_required</span></code></p>
<dl class="docutils">
<dt>access for role:</dt>
<dd>admin</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">request headers:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body"><ul class="first simple">
<li>Accept: <cite>application/json, text/plain, */*</cite></li>
<li>Authorization: <cite>remember_token to authenticate</cite></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">response header:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><ul class="first last simple">
<li>Content-Type: <cite>application/json</cite></li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="get">
<dt id="get--api-role_permissions">
<code class="descname">GET </code><code class="descname">/api/role_permissions</code><a class="headerlink" href="#get--api-role_permissions" title="Permalink to this definition">¶</a></dt>
<dd><p>Function which gets all permissions from database and all actual
permissions for current role.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Query Parameters:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body"><ul class="first simple">
<li><strong>role_id</strong> &#8211; set specific id of user role for showing its actual list
of permissions</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><p class="first"><code class="docutils literal"><span class="pre">{'actual':</span> <span class="pre">[list</span> <span class="pre">of</span> <span class="pre">actual</span> <span class="pre">permissions</span> <span class="pre">for</span> <span class="pre">role],</span>
<span class="pre">'all_permissions':</span> <span class="pre">[list</span> <span class="pre">of</span> <span class="pre">all</span> <span class="pre">permissions]}</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first last">JSON</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="post">
<dt id="post--api-role_permissions">
<code class="descname">POST </code><code class="descname">/api/role_permissions</code><a class="headerlink" href="#post--api-role_permissions" title="Permalink to this definition">¶</a></dt>
<dd><p>Function which binds permission with role.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Request args example:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first"><cite>{permission_id: 5, role_id: 4}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If request data is not valid:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">False,</span> <span class="pre">'error':</span> <span class="pre">[list</span> <span class="pre">of</span> <span class="pre">errors]}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If all ok:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'added_role_permission_for_role':</span> <span class="pre">'role_id'}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400 Bad Request</a> &#8211; if role has assigned permissions or request invalid</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; if no errors</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="put">
<dt id="put--api-role_permissions">
<code class="descname">PUT </code><code class="descname">/api/role_permissions</code><a class="headerlink" href="#put--api-role_permissions" title="Permalink to this definition">¶</a></dt>
<dd><p>Function which sets list of permission to role. Before sets
removes all permissions from role.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Request args example:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first"><cite>{permission_id: 5, role_id: 4}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first last">
<li><dl class="first docutils">
<dt>If request data is not invalid&#8217;:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">False,</span> <span class="pre">'error':</span> <span class="pre">[list</span> <span class="pre">of</span> <span class="pre">errors]}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If all ok:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'msg':</span> <span class="pre">'edited</span> <span class="pre">permission'}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="delete">
<dt id="delete--api-role_permissions">
<code class="descname">DELETE </code><code class="descname">/api/role_permissions</code><a class="headerlink" href="#delete--api-role_permissions" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to delete permissions by role id.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Request args example:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first"><cite>{role_id: 4}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first last">
<li><dl class="first docutils">
<dt>If request data is not invalid&#8217;:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">False,</span> <span class="pre">'error':</span> <span class="pre">[list</span> <span class="pre">of</span> <span class="pre">errors]}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If all ok:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'msg':</span> <span class="pre">'deleted</span> <span class="pre">permission'}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="static-pages-api">
<h3>Static Pages API<a class="headerlink" href="#static-pages-api" title="Permalink to this headline">¶</a></h3>
<dl class="post">
<dt id="post--api-addResource">
<code class="descname">POST </code><code class="descname">/api/addResource</code><a class="headerlink" href="#post--api-addResource" title="Permalink to this definition">¶</a></dt>
<dd><p>This method adds new page to db.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Request agrs:</th><td class="field-body"><p class="first"><cite>{&#8216;title&#8217;: &#8216;new page&#8217;, &#8216;alias&#8217;: &#8216;tag&#8217;,
&#8216;description&#8217;: &#8216;short description of page&#8217;,
&#8216;content&#8217;: &#8216;main article content&#8217;,
&#8216;meta_keywords&#8217;: &#8216;keyword1, keyword2&#8217;,
&#8216;meta_description&#8217;: &#8216;meta-description of content&#8217;,
&#8216;is_enabled&#8217;: 1}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If there is already page with this name:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'result':</span> <span class="pre">'False',</span> <span class="pre">'msg':</span> <span class="pre">'Page</span> <span class="pre">already</span> <span class="pre">exists!'}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If request data is invalid:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'result':</span> <span class="pre">'False',</span> <span class="pre">'msg':</span> <span class="pre">'Couldn't</span> <span class="pre">add</span> <span class="pre">new</span> <span class="pre">page!'}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If all ok:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'result':</span> <span class="pre">'True',</span> <span class="pre">'msg':</span> <span class="pre">'Succesfully</span> <span class="pre">added!'}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; check status in response json object</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="put">
<dt id="put--api-editResource-(int-page_id)">
<code class="descname">PUT </code><code class="descname">/api/editResource/</code><span class="sig-paren">(</span><em class="property">int: </em><em>page_id</em><span class="sig-paren">)</span><a class="headerlink" href="#put--api-editResource-(int-page_id)" title="Permalink to this definition">¶</a></dt>
<dd><p>This method makes changes to given page(ex-resource) via
page_id, passed to it.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>page_id</strong> &#8211; id of specific page to edit.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Request agrs example:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first"><cite>{&#8216;id&#8217;: 1, &#8216;title&#8217;: &#8216;title&#8217;, &#8216;alias&#8217;: &#8216;tag&#8217;,
&#8216;description&#8217;: &#8216;small description of page&#8217;,
&#8216;content&#8217;: &#8216;main article content&#8217;,
&#8216;meta_keywords&#8217;: &#8216;keyword1, keyword2&#8217;,
&#8216;meta_description&#8217;: &#8216;meta-description of content&#8217;,
&#8216;is_enabled&#8217;: 1}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><p class="first">confirmation object</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">JSON sample:</th><td class="field-body"><p class="first"><code class="docutils literal"><span class="pre">{'result':</span> <span class="pre">true}</span></code>
or
<code class="docutils literal"><span class="pre">{'result':</span> <span class="pre">false}</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; successfully edited</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.5">404 Not Found</a> &#8211; no page by given id</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="delete">
<dt id="delete--api-deleteResource-(page_id)">
<code class="descname">DELETE </code><code class="descname">/api/deleteResource/</code><span class="sig-paren">(</span><em>page_id</em><span class="sig-paren">)</span><a class="headerlink" href="#delete--api-deleteResource-(page_id)" title="Permalink to this definition">¶</a></dt>
<dd><p>This method deletes page by it&#8217;s id.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>page_id</strong> &#8211; id of specific page to delete.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Request agrs example:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><p class="first"><cite>{&#8216;id&#8217;: 1}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><p class="first">confirmation object</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">JSON sample:</th><td class="field-body"><p class="first last"><code class="docutils literal"><span class="pre">{'result':</span> <span class="pre">true,</span> <span class="pre">'msg':</span> <span class="pre">'Page</span> <span class="pre">was</span> <span class="pre">deleted</span> <span class="pre">successfully!'}</span></code></p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>or</dt>
<dd><code class="docutils literal"><span class="pre">{'result':</span> <span class="pre">false,</span> <span class="pre">'msg':</span> <span class="pre">'Couldn't</span> <span class="pre">delete</span> <span class="pre">the</span> <span class="pre">page'}</span></code></dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; successfully edited</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.5">404 Not Found</a> &#8211; no page by given id</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="get">
<dt id="get--api-getTitles">
<code class="descname">GET </code><code class="descname">/api/getTitles</code><a class="headerlink" href="#get--api-getTitles" title="Permalink to this definition">¶</a></dt>
<dd><p>This method returns short info about all defined static pages.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body">list of dicts with title, id, alias and is_enabled</td>
</tr>
<tr class="field-even field"><th class="field-name">Rtype:</th><td class="field-body">JSON</td>
</tr>
<tr class="field-odd field"><th class="field-name">JSON sample:</th><td class="field-body"><code class="docutils literal"><span class="pre">[{'is_enabled':</span> <span class="pre">1,</span>
<span class="pre">'alias':</span> <span class="pre">'alias_Tag',</span>
<span class="pre">'id':</span> <span class="pre">1,</span>
<span class="pre">'title':</span> <span class="pre">'Custom_Title'},</span>
<span class="pre">{'is_enabled':</span> <span class="pre">1,</span>
<span class="pre">'alias':</span> <span class="pre">'Tag',</span>
<span class="pre">'id':</span> <span class="pre">2,</span>
<span class="pre">'title':</span> <span class="pre">'AnotherTitle'}]</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="get">
<dt id="get--api-resources-(alias)">
<code class="descname">GET </code><code class="descname">/api/resources/</code><span class="sig-paren">(</span><em>alias</em><span class="sig-paren">)</span><a class="headerlink" href="#get--api-resources-(alias)" title="Permalink to this definition">¶</a></dt>
<dd><p>This method retrieves exact faq page(ex-resource) via
alias, passed to it.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>alias</strong> &#8211; url path to specific static page.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><p class="first">object with all page&#8217;s attributes within a list or <code class="docutils literal"><span class="pre">404</span></code>
status.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">JSON sample:</th><td class="field-body"><p class="first last"><code class="docutils literal"><span class="pre">[{'id':</span> <span class="pre">1,</span> <span class="pre">'title':</span> <span class="pre">'title',</span> <span class="pre">'alias':</span> <span class="pre">'tag',</span>
<span class="pre">'description':</span> <span class="pre">'small</span> <span class="pre">description</span> <span class="pre">of</span> <span class="pre">page',</span>
<span class="pre">'content':</span> <span class="pre">'main</span> <span class="pre">article</span> <span class="pre">content',</span>
<span class="pre">'meta_keywords':</span> <span class="pre">'keyword1,</span> <span class="pre">keyword2',</span>
<span class="pre">'meta_description':</span> <span class="pre">'meta-description</span> <span class="pre">of</span> <span class="pre">content',</span>
<span class="pre">'is_enabled':</span> <span class="pre">1}]</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="user-api">
<h2>User API<a class="headerlink" href="#user-api" title="Permalink to this headline">¶</a></h2>
<p>main application api</p>
<div class="section" id="authentication">
<h3>authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h3>
<p>routes provides site logging and app authentication functions</p>
<span class="target" id="module-authorize_views"></span><p>Module contains routes for user authorization,
registering and logout.</p>
<dl class="function">
<dt id="authorize_views.register">
<code class="descclassname">authorize_views.</code><code class="descname">register</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="modules/authorize_views.html#register"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#authorize_views.register" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="post">
<dt id="post--api-register">
<code class="descname">POST </code><code class="descname">/api/register</code><a class="headerlink" href="#post--api-register" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for registration new user in db.
Method checks if user is not exists and handle
registration processes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Request args:</th><td class="field-body"><p class="first"><cite>{&#8216;first_name&#8217;: &#8216;Ivan&#8217;,
&#8216;last_name&#8217;: &#8216;Sirko&#8217;,
&#8216;email&#8217;: &#8216;email&#64;test.com&#8217;,
&#8216;password&#8217;: &#8216;passw&#8217;}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>if one of the field is incorrect or empty:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'error':'Unauthorized'}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>if user already exists</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">'user</span> <span class="pre">with</span> <span class="pre">this</span> <span class="pre">email</span> <span class="pre">already</span> <span class="pre">exists'}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>if registration was successful:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">added</span> <span class="pre">user</span> <span class="pre">&lt;username&gt;}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.2">401 Unauthorized</a> &#8211; form is invalid or empty</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400 Bad Request</a> &#8211; user already exists</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; registration successful</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="post">
<dt id="post--api-login">
<code class="descname">POST </code><code class="descname">/api/login</code><a class="headerlink" href="#post--api-login" title="Permalink to this definition">¶</a></dt>
<dd><p>Login processes handler.
Log user in or shows error messages.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Request args:</th><td class="field-body"><p class="first"><cite>{&#8216;email&#8217;: &#8216;username&#64;mail.com&#8217;,
&#8216;password&#8217;: &#8216;userpaswd&#8217;}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>if credentials are ok and log in successful:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{&quot;email&quot;:</span> <span class="pre">&quot;username&#64;mail.com&quot;,</span>
<span class="pre">&quot;iat&quot;:</span> <span class="pre">&quot;???&quot;,</span>
<span class="pre">&quot;id&quot;:</span> <span class="pre">6,</span>
<span class="pre">&quot;name&quot;:</span> <span class="pre">&quot;oleg&quot;,</span>
<span class="pre">&quot;role&quot;:</span> <span class="pre">&quot;admin&quot;,</span>
<span class="pre">&quot;surname&quot;:</span> <span class="pre">&quot;lyashko&quot;,</span>
<span class="pre">&quot;token&quot;:</span> <span class="pre">&quot;hashed_auth_token&quot;}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>if user with entered email isn&#8217;t exists or password was invalid:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'error':'message'}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.2">401 Unauthorized</a> &#8211; user doesn&#8217;t exist or password is invalid</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400 Bad Request</a> &#8211; login data has invalid format:</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; credentials are ok</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="post">
<dt id="post--api-logout">
<code class="descname">POST </code><code class="descname">/api/logout</code><a class="headerlink" href="#post--api-logout" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for user&#8217;s log out.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><ul class="first last">
<li><dl class="first docutils">
<dt>if logging out was successful:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{result:True}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>in case of problems:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{result:False}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="get">
<dt id="get--api-logout">
<code class="descname">GET </code><code class="descname">/api/logout</code><a class="headerlink" href="#get--api-logout" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for user&#8217;s log out.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><ul class="first last">
<li><dl class="first docutils">
<dt>if logging out was successful:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{result:True}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>in case of problems:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{result:False}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="post">
<dt id="post--api-email_exist">
<code class="descname">POST </code><code class="descname">/api/email_exist</code><a class="headerlink" href="#post--api-email_exist" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for AJAX call from frontend.
Validates unique email identifier before registering a new user
:return: json with status 200 or 400</p>
</dd></dl>

<dl class="post">
<dt id="post--api-authorize-(provider)">
<code class="descname">POST </code><code class="descname">/api/authorize/</code><span class="sig-paren">(</span><em>provider</em><span class="sig-paren">)</span><a class="headerlink" href="#post--api-authorize-(provider)" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides facebook authorization.
Retrieves user info from facebook, check if there is
user with retrieved from facebook user id,
:param provider: Oauth provider (Facebook by default)</p>
<blockquote>
<div><ul>
<li><dl class="first docutils">
<dt>if yes:</dt>
<dd><p class="first last">skips to next step</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>if not:</dt>
<dd><p class="first">checks if there is user with retrieved email
- if yes:</p>
<blockquote>
<div><p>adds oauth credentials to this user</p>
</div></blockquote>
<ul class="last">
<li><dl class="first docutils">
<dt>if not:</dt>
<dd><p class="first last">creates new user</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>After all function logging in user into app and return it&#8217;s params</p>
</div></blockquote>
</dd></dl>

<dl class="get">
<dt id="get--api-authorize-(provider)">
<code class="descname">GET </code><code class="descname">/api/authorize/</code><span class="sig-paren">(</span><em>provider</em><span class="sig-paren">)</span><a class="headerlink" href="#get--api-authorize-(provider)" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides facebook authorization.
Retrieves user info from facebook, check if there is
user with retrieved from facebook user id,
:param provider: Oauth provider (Facebook by default)</p>
<blockquote>
<div><ul>
<li><dl class="first docutils">
<dt>if yes:</dt>
<dd><p class="first last">skips to next step</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>if not:</dt>
<dd><p class="first">checks if there is user with retrieved email
- if yes:</p>
<blockquote>
<div><p>adds oauth credentials to this user</p>
</div></blockquote>
<ul class="last">
<li><dl class="first docutils">
<dt>if not:</dt>
<dd><p class="first last">creates new user</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>After all function logging in user into app and return it&#8217;s params</p>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="restore-user-password">
<h3>restore user password<a class="headerlink" href="#restore-user-password" title="Permalink to this headline">¶</a></h3>
<p>routes provides restoring user account password</p>
<dl class="post">
<dt id="post--api-restore_password">
<code class="descname">POST </code><code class="descname">/api/restore_password</code><a class="headerlink" href="#post--api-restore_password" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to restore forgotten password.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Request args:</th><td class="field-body"><p class="first"><cite>{&#8216;email&#8217;: &#8216;username&#64;mail.com&#8217;}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>if credentials are ok and checking successful:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{message='Email</span> <span class="pre">was</span> <span class="pre">sended.'}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>if user&#8217;s email isn&#8217;t exists:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'error':'There</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">such</span> <span class="pre">email.'}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.2">401 Unauthorized</a> &#8211; no email</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; email sended</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="get">
<dt id="get--api-restore_password_page-(string-hashed)">
<code class="descname">GET </code><code class="descname">/api/restore_password_page/</code><span class="sig-paren">(</span><em class="property">string: </em><em>hashed</em><span class="sig-paren">)</span><a class="headerlink" href="#get--api-restore_password_page-(string-hashed)" title="Permalink to this definition">¶</a></dt>
<dd><p>Renders page template to restore password.
:param hashed: unique hash to identify user via sending it to email.</p>
<p>:return redirect to main page with rendered template.</p>
</dd></dl>

<dl class="put">
<dt id="put--api-restore_password">
<code class="descname">PUT </code><code class="descname">/api/restore_password</code><a class="headerlink" href="#put--api-restore_password" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates user password.</p>
</dd></dl>

</div>
<div class="section" id="change-user-password">
<h3>change user password<a class="headerlink" href="#change-user-password" title="Permalink to this headline">¶</a></h3>
<dl class="post">
<dt id="post--api-change_password">
<code class="descname">POST </code><code class="descname">/api/change_password</code><a class="headerlink" href="#post--api-change_password" title="Permalink to this definition">¶</a></dt>
<dd><p>Function, used to change user password.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Request agrs:</th><td class="field-body"><p class="first"><cite>{id: &#8220;6&#8221;, old_pass: &#8220;oldpasswd&#8221;, password: &#8220;newpasswd&#8221;}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><table class="first last docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">statuscode 400:</th><td class="field-body">request is invalid or old password not confirmed</td>
</tr>
<tr class="field-even field"><th class="field-name">statuscode 200:</th><td class="field-body">password was successfully changed</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="user-profile">
<h3>user profile<a class="headerlink" href="#user-profile" title="Permalink to this headline">¶</a></h3>
<dl class="get">
<dt id="get--api-user_detailed_info-(int-user_id)">
<code class="descname">GET </code><code class="descname">/api/user_detailed_info/</code><span class="sig-paren">(</span><em class="property">int: </em><em>user_id</em><span class="sig-paren">)</span><a class="headerlink" href="#get--api-user_detailed_info-(int-user_id)" title="Permalink to this definition">¶</a></dt>
<dd><p>This method returns json object with user data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>user_id</strong> &#8211; id of user for viewing detailed info</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If user exists and data provided:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{&quot;avatar&quot;:</span> <span class="pre">&quot;/uploads/user_profile/userid_6/profile_id6.png&quot;,</span>
<span class="pre">&quot;email&quot;:</span> <span class="pre">&quot;email&#64;email.com&quot;,</span> <span class="pre">&quot;name&quot;:</span> <span class="pre">&quot;Firstname&quot;,</span> <span class="pre">&quot;role&quot;:</span> <span class="pre">&quot;admin&quot;,</span>
<span class="pre">&quot;surname&quot;:</span> <span class="pre">&quot;Lastname&quot;}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If there is no user with given email:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{status:'There</span> <span class="pre">is</span> <span class="pre">no</span> <span class="pre">user</span> <span class="pre">with</span> <span class="pre">given</span> <span class="pre">email'}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.2">401 Unauthorized</a> &#8211; there is no user with given email</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; user exists and data provided</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="post">
<dt id="post--api-user_avatar">
<code class="descname">POST </code><code class="descname">/api/user_avatar</code><a class="headerlink" href="#post--api-user_avatar" title="Permalink to this definition">¶</a></dt>
<dd><p>Controller provides add and edit function for user&#8217;s profile photo.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Content-type:</th><td class="field-body"><p class="first">multipart/form-data</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Form Parameters:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><ul class="first simple">
<li><strong>name</strong> &#8211; name of image file (&#8216;photo.jpg&#8217;)</li>
<li><strong>file</strong> &#8211; image file in base64. Content-Type: image/png</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><p class="first">json object with image path if success or 400 error message</p>
<ul>
<li><dl class="first docutils">
<dt>If request data is invalid:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'error':</span> <span class="pre">'error</span> <span class="pre">with</span> <span class="pre">import</span> <span class="pre">file'}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If all ok:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{added_file:</span> <span class="pre">&quot;/uploads/user_profile/userid_6/profile_id6.png&quot;}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400 Bad Request</a> &#8211; request is invalid</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; photo was successfully added</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="delete">
<dt id="delete--api-user_avatar">
<code class="descname">DELETE </code><code class="descname">/api/user_avatar</code><a class="headerlink" href="#delete--api-user_avatar" title="Permalink to this definition">¶</a></dt>
<dd><p>Controller for handling deleting user&#8217;s profile photo.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Request args:</th><td class="field-body"><p class="first"><cite>{&#8216;user_id&#8217;: &#8216;6&#8217;}</cite></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><p class="first">json object with success message or message with error status</p>
<ul>
<li><dl class="first docutils">
<dt>If all ok:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{deleted_avatar:</span> <span class="pre">&quot;6&quot;,</span> <span class="pre">msg:</span> <span class="pre">&quot;success&quot;}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400 Bad Request</a> &#8211; request invalid</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; successfully deleted</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="problem-api">
<h2>Problem API<a class="headerlink" href="#problem-api" title="Permalink to this headline">¶</a></h2>
<p>routes handling API connected with adding and managing environment problems</p>
<div class="section" id="module-problem_views">
<span id="adding-and-viewing-problems"></span><h3>adding and viewing problems<a class="headerlink" href="#module-problem_views" title="Permalink to this headline">¶</a></h3>
<p>Module contains routes, used for problem table.</p>
<dl class="function">
<dt id="problem_views.problems">
<code class="descclassname">problem_views.</code><code class="descname">problems</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="modules/problem_views.html#problems"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#problem_views.problems" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="get">
<dt id="get--api-problems">
<code class="descname">GET </code><code class="descname">/api/problems</code><a class="headerlink" href="#get--api-problems" title="Permalink to this definition">¶</a></dt>
<dd><p>Handler for sending short data about all problem stored in db.
Used by Google Map instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If problems list not empty:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">[{&quot;status&quot;:</span> <span class="pre">&quot;Unsolved&quot;,</span> <span class="pre">&quot;problem_type_Id&quot;:</span> <span class="pre">2,</span>
<span class="pre">&quot;title&quot;:</span> <span class="pre">&quot;problem</span> <span class="pre">1&quot;,&quot;longitude&quot;:</span> <span class="pre">25.9717,</span> <span class="pre">&quot;date&quot;:</span> <span class="pre">1450735578,</span>
<span class="pre">&quot;latitude&quot;:</span> <span class="pre">50.2893,</span> <span class="pre">&quot;problem_id&quot;:</span> <span class="pre">75},</span>
<span class="pre">{&quot;status&quot;:</span> <span class="pre">&quot;Unsolved&quot;,</span> <span class="pre">&quot;problem_type_Id&quot;:</span> <span class="pre">3,</span>
<span class="pre">&quot;title&quot;:</span> <span class="pre">&quot;problem</span> <span class="pre">2&quot;,</span> <span class="pre">&quot;longitude&quot;:</span> <span class="pre">24.7852,</span> <span class="pre">&quot;date&quot;:</span> <span class="pre">1450738061,</span>
<span class="pre">&quot;latitude&quot;:</span> <span class="pre">49.205,</span> <span class="pre">&quot;problem_id&quot;:</span> <span class="pre">76}]</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If problem list is empty:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; no errors</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="get">
<dt id="get--api-problem_detailed_info-(int-problem_id)">
<code class="descname">GET </code><code class="descname">/api/problem_detailed_info/</code><span class="sig-paren">(</span><em class="property">int: </em><em>problem_id</em><span class="sig-paren">)</span><a class="headerlink" href="#get--api-problem_detailed_info-(int-problem_id)" title="Permalink to this definition">¶</a></dt>
<dd><p>This method returns object with detailed problem data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>problem_id</strong> &#8211; <cite>{problem_id: 82}</cite></li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If problem exists:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">[[{&quot;content&quot;:</span> <span class="pre">&quot;Text</span> <span class="pre">with</span> <span class="pre">situation&quot;,</span> <span class="pre">&quot;status&quot;:</span> <span class="pre">&quot;Unsolved&quot;,</span>
<span class="pre">&quot;date&quot;:</span> <span class="pre">1450954447,</span> <span class="pre">&quot;severity&quot;:</span> <span class="pre">&quot;1&quot;,</span> <span class="pre">&quot;title&quot;:</span> <span class="pre">&quot;problem&quot;,</span>
<span class="pre">&quot;latitude&quot;:</span> <span class="pre">52.7762,</span> <span class="pre">&quot;proposal&quot;:</span> <span class="pre">&quot;proposal</span> <span class="pre">how</span> <span class="pre">to</span> <span class="pre">solve&quot;,</span>
<span class="pre">&quot;problem_type_id&quot;:</span> <span class="pre">3,</span> <span class="pre">&quot;problem_id&quot;:</span> <span class="pre">82,</span> <span class="pre">&quot;longitude&quot;:</span> <span class="pre">34.2114}],</span>
<span class="pre">[{&quot;activity_type&quot;:</span> <span class="pre">&quot;Added&quot;,</span> <span class="pre">&quot;user_id&quot;:</span> <span class="pre">5,</span>
<span class="pre">&quot;problem_id&quot;:</span> <span class="pre">82,</span> <span class="pre">&quot;created_date&quot;:</span> <span class="pre">1450954447}],</span> 
<span class="pre">[{&quot;url&quot;:</span> <span class="pre">&quot;/uploads/problems/82/0d0d3ef56a16bd069e.png&quot;,</span>
<span class="pre">&quot;user_id&quot;:</span> <span class="pre">5,</span> <span class="pre">&quot;description&quot;:</span> <span class="pre">&quot;description</span> <span class="pre">to</span> <span class="pre">photo&quot;}],</span> 
<span class="pre">[{&quot;user_id&quot;:</span> <span class="pre">5,</span> <span class="pre">&quot;name&quot;:</span> <span class="pre">&quot;User&quot;,</span> <span class="pre">&quot;problem_id&quot;:</span> <span class="pre">82,</span>
<span class="pre">&quot;content&quot;:</span> <span class="pre">&quot;Comment&quot;,</span> <span class="pre">&quot;created_date&quot;:</span> <span class="pre">1450954929000,</span>
<span class="pre">&quot;id&quot;:</span> <span class="pre">5}]]</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If problem not exists:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{&quot;message&quot;:</span> <span class="pre">&quot;</span> <span class="pre">resource</span> <span class="pre">not</span> <span class="pre">exists&quot;}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.5">404 Not Found</a> &#8211; problem not exists</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; problem displayed</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="post">
<dt id="post--api-problem_post">
<code class="descname">POST </code><code class="descname">/api/problem_post</code><a class="headerlink" href="#post--api-problem_post" title="Permalink to this definition">¶</a></dt>
<dd><p>Function which adds data about created problem into DB.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Content-type:</th><td class="field-body"><p class="first">multipart/form-data</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Form Parameters:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><ul class="first simple">
<li><strong>title</strong> &#8211; Title of problem (&#8216;problem with rivers&#8217;)</li>
<li><strong>type</strong> &#8211; id of problem type (2)</li>
<li><strong>lat</strong> &#8211; lat coordinates (49.8256101)</li>
<li><strong>longitude</strong> &#8211; lon coordinates (24.0600542)</li>
<li><strong>content</strong> &#8211; description of problem (&#8216;some text&#8217;)</li>
<li><strong>proposal</strong> &#8211; proposition for solving problem (&#8216;text&#8217;)</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If request data is invalid:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{'status':</span> <span class="pre">False,</span> <span class="pre">'error':</span> <span class="pre">[list</span> <span class="pre">of</span> <span class="pre">errors]}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If all ok:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{&quot;added_problem&quot;:</span> <span class="pre">&quot;problem</span> <span class="pre">title&quot;,</span> <span class="pre">&quot;problem_id&quot;:</span> <span class="pre">83}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400 Bad Request</a> &#8211; request is invalid</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; problem was successfully posted</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="get">
<dt id="get--api-usersProblem-(int-user_id)">
<code class="descname">GET </code><code class="descname">/api/usersProblem/</code><span class="sig-paren">(</span><em class="property">int: </em><em>user_id</em><span class="sig-paren">)</span><a class="headerlink" href="#get--api-usersProblem-(int-user_id)" title="Permalink to this definition">¶</a></dt>
<dd><p>This method retrieves all user&#8217;s problem from db and shows it in user
profile page on <cite>my problems</cite> tab.</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">param  user_id:</th><td class="field-body"><p class="first">id of user (int)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If user has problems:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">[{&quot;id&quot;:</span> <span class="pre">190,&quot;title&quot;:</span> <span class="pre">&quot;name&quot;,</span>
<span class="pre">&quot;latitude&quot;:</span> <span class="pre">51.419765,</span>
<span class="pre">&quot;longitude&quot;:</span> <span class="pre">29.520264,</span>
<span class="pre">&quot;problem_type_id&quot;:</span> <span class="pre">1,</span>
<span class="pre">&quot;status&quot;:</span> <span class="pre">0,</span>
<span class="pre">&quot;date&quot;:</span> <span class="pre">&quot;2015-02-24T14:27:22.000Z&quot;,</span>
<span class="pre">&quot;severity&quot;:</span> <span class="pre">'3',</span>
<span class="pre">&quot;is_enabled&quot;:</span> <span class="pre">1</span>
<span class="pre">},{...}]</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If user haven&#8217;t:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">statuscode 200:</th><td class="field-body"><p class="first last">no errors</p>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
</dd></dl>

<dl class="get">
<dt id="get--api-all_usersProblem">
<code class="descname">GET </code><code class="descname">/api/all_usersProblem</code><a class="headerlink" href="#get--api-all_usersProblem" title="Permalink to this definition">¶</a></dt>
<dd><p>This method retrieves all user&#8217;s problem from db.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Query Parameters:</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body"><ul class="first simple">
<li><strong>limit</strong> &#8211; limit number. default is 5</li>
<li><strong>offset</strong> &#8211; offset number. default is 0</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><p class="first">list of user&#8217;s problem represented with next objects:</p>
<p class="last"><code class="docutils literal"><span class="pre">[{&quot;id&quot;:</span> <span class="pre">190,</span>
<span class="pre">&quot;title&quot;:</span> <span class="pre">&quot;name&quot;,</span>
<span class="pre">&quot;latitude&quot;:</span> <span class="pre">51.419765,</span>
<span class="pre">&quot;longitude&quot;:</span> <span class="pre">29.520264,</span>
<span class="pre">&quot;problem_type_id&quot;:</span> <span class="pre">1,</span>
<span class="pre">&quot;status&quot;:</span> <span class="pre">0,</span>
<span class="pre">&quot;date&quot;:</span> <span class="pre">&quot;2015-02-24T14:27:22.000Z&quot;,</span>
<span class="pre">&quot;severity&quot;:</span> <span class="pre">'3',</span>
<span class="pre">&quot;is_enabled&quot;:</span> <span class="pre">1},...]</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="photos">
<h3>photos<a class="headerlink" href="#photos" title="Permalink to this headline">¶</a></h3>
<dl class="post">
<dt id="post--api-photo-(int-problem_id)">
<code class="descname">POST </code><code class="descname">/api/photo/</code><span class="sig-paren">(</span><em class="property">int: </em><em>problem_id</em><span class="sig-paren">)</span><a class="headerlink" href="#post--api-photo-(int-problem_id)" title="Permalink to this definition">¶</a></dt>
<dd><p>Controller for handling adding problem photos.</p>
<p><strong>param</strong> problem_id - id of problem instance for uploading new photos.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Content-type:</th><td class="field-body"><p class="first">multipart/form-data</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Form Parameters:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><ul class="first simple">
<li><strong>file</strong> &#8211; image file in base64. Content-Type: image/png</li>
<li><strong>name</strong> &#8211; image name (<cite>&#8216;image.jpg&#8217;</cite>)</li>
<li><strong>description</strong> &#8211; description of image (<cite>&#8216;some text&#8217;</cite>)</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><p class="first">json object with success message or message with error status.</p>
<ul>
<li><dl class="first docutils">
<dt>if success:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{&quot;added_file&quot;:</span> <span class="pre">&quot;/uploads/problems/77/df4c22114eb24442e8b6.png&quot;}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400 Bad Request</a> &#8211; error with attaching image or request is invalid</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; successfully added</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="comments">
<h3>comments<a class="headerlink" href="#comments" title="Permalink to this headline">¶</a></h3>
<p>functions for adding and viewing comments of problems</p>
<dl class="post">
<dt id="post--api-problem-add_comment">
<code class="descname">POST </code><code class="descname">/api/problem/add_comment</code><a class="headerlink" href="#post--api-problem-add_comment" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds new comment to problem.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Request args:</th><td class="field-body"><p class="first"><cite>{content: &#8220;comment&#8221;, problem_id: &#8220;77&#8221;}</cite></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>if success:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{&quot;message&quot;:</span> <span class="pre">&quot;Comment</span> <span class="pre">successfully</span> <span class="pre">added.&quot;}</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>if some error:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{error:</span> <span class="pre">&quot;type</span> <span class="pre">of</span> <span class="pre">validation</span> <span class="pre">error&quot;}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.1">400 Bad Request</a> &#8211; error with adding comment or request is invalid</li>
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; successfully added</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="get">
<dt id="get--api-problem_comments-(int-problem_id)">
<code class="descname">GET </code><code class="descname">/api/problem_comments/</code><span class="sig-paren">(</span><em class="property">int: </em><em>problem_id</em><span class="sig-paren">)</span><a class="headerlink" href="#get--api-problem_comments-(int-problem_id)" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all problem comments</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Rtype:</th><td class="field-body"><p class="first">JSON</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>problem_id</strong> &#8211; id of problem (int)</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><ul class="first">
<li><dl class="first docutils">
<dt>If problem has comments:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">[{content:</span> <span class="pre">&quot;some</span> <span class="pre">comment&quot;,</span>
<span class="pre">created_date:</span> <span class="pre">1451001050000,</span>
<span class="pre">id:</span> <span class="pre">29,</span>
<span class="pre">name:</span> <span class="pre">&quot;user</span> <span class="pre">name&quot;,</span>
<span class="pre">problem_id:</span> <span class="pre">77,</span>
<span class="pre">user_id:</span> <span class="pre">6,</span>
<span class="pre">},{...}]</span></code></p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If user hasn&#8217;t:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">{}</span></code></p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Status Codes:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.1">200 OK</a> &#8211; no errors</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="about.html" class="btn btn-neutral float-right" title="About Project" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to Ecomap.org documentation!" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, lv-164.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="static/jquery.js"></script>
      <script type="text/javascript" src="static/underscore.js"></script>
      <script type="text/javascript" src="static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>